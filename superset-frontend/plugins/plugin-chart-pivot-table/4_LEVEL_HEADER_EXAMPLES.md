# 4-х уровневая шапка и перемещение колонок - Примеры

## Пример 1: Структура с 4 уровнями

### Header Tree JSON:
```json
{
  "groups": [
    {
      "title": "Начальные запасы",
      "subgroups": [
        {
          "title": "Свободный газ",
          "segments": [
            {
              "title": "Геологические",
              "subsegments": [
                { "title": "Категория A", "count": 2 },
                { "title": "Категория B", "count": 2 }
              ]
            },
            {
              "title": "Извлекаемые",
              "subsegments": [
                { "title": "Категория C", "count": 2 }
              ]
            }
          ]
        }
      ]
    },
    {
      "title": "Текущие показатели",
      "subgroups": [
        {
          "title": "Добыча",
          "count": 4
        }
      ]
    }
  ],
  "showSegments": true
}
```

### Ожидаемая структура:
```
Начальные запасы → Свободный газ → Геологические → Категория A: [metric1, metric2]
Начальные запасы → Свободный газ → Геологические → Категория B: [metric3, metric4]  
Начальные запасы → Свободный газ → Извлекаемые → Категория C: [metric5, metric6]
Текущие показатели → Добыча: [metric7, metric8, metric9, metric10]
```

## Пример 2: Platform Mapping с 4 уровнями

### Platform to Header Mapping:
```json
{
  "PS2": {
    "level1": "Начальные запасы",
    "level2": "Свободный газ", 
    "level3": "Геологические",
    "level4": "Категория A"
  },
  "DS": {
    "level1": "Начальные запасы",
    "level2": "Свободный газ",
    "level3": "Извлекаемые", 
    "level4": "Категория C"
  },
  "Wii": {
    "level1": "Текущие показатели",
    "level2": "Добыча"
  }
}
```

**Результат**: PS2 попадет под "Начальные запасы → Свободный газ → Геологические → Категория A", DS под "Категория C", Wii под "Добыча".

## Пример 3: Grouped Swaps

### Grouped Column Swaps:
```json
{
  "Начальные запасы": [[0,1], [2,3]],
  "Текущие показатели": [[0,2]]
}
```

**Значение**:
- В группе "Начальные запасы": поменять местами колонки 0↔1 и 2↔3 (внутри этой группы)
- В группе "Текущие показатели": поменять местами колонки 0↔2 (внутри этой группы)

## Пример 4: Полная конфигурация

### Header Tree (4 уровня):
```json
{
  "groups": [
    {
      "title": "Запасы нефти",
      "subgroups": [
        {
          "title": "Месторождение А",
          "segments": [
            {
              "title": "Пласт 1", 
              "subsegments": [
                { "title": "Зона север", "count": 1 },
                { "title": "Зона юг", "count": 1 }
              ]
            }
          ]
        },
        {
          "title": "Месторождение Б",
          "segments": [
            {
              "title": "Пласт 2",
              "count": 2
            }
          ]
        }
      ]
    },
    {
      "title": "Запасы газа", 
      "subgroups": [
        {
          "title": "Месторождение В",
          "count": 3  
        }
      ]
    }
  ],
  "showSegments": true
}
```

### Platform Mapping:
```json
{
  "скважина_1": {
    "level1": "Запасы нефти",
    "level2": "Месторождение А", 
    "level3": "Пласт 1",
    "level4": "Зона север"
  },
  "скважина_2": {
    "level1": "Запасы нефти",
    "level2": "Месторождение А",
    "level3": "Пласт 1", 
    "level4": "Зона юг"
  },
  "скважина_3": {
    "level1": "Запасы газа",
    "level2": "Месторождение В"
  }
}
```

### Grouped Swaps:
```json
{
  "Запасы нефти": [[0,1], [2,3]],
  "Запасы газа": [[1,2]]  
}
```

## Результат:
- **4-х уровневая иерархия** создает детализированную структуру заголовков
- **Platform mapping** автоматически размещает platforms по нужным категориям
- **Grouped swaps** позволяет переставлять колонки только внутри конкретных групп верхнего уровня
- **Консольные логи** показывают всю структуру для отладки

## Отладка:

В консоли браузера смотрите:
1. `Column Groups Info` - показывает найденные группы и их индексы
2. `platform mapping match` - когда срабатывает mapping
3. `Swaps Combination` - как объединяются обычные и grouped swaps
4. Предупреждения если swaps нарушают границы групп

Теперь можно создавать сложные многоуровневые структуры и гибко перемещать колонки только внутри нужных групп!